---
import SidebarLayout from '../../layouts/SidebarLayout.astro';
---
<SidebarLayout title="Command Palette">
  <main>
<ui-stack gap="6">
    <div>
      <h1>Command Palette</h1>
      <p style="color: var(--neutral-ink-muted); font-size: 0.875rem;">
        Quick-access command palette in a dialog overlay. Searchable, keyboard navigable,
        and grouped by category. Opens via button click or <kbd>Ctrl+K</kbd> shortcut.
      </p>
    </div>

    <!-- -- Trigger Area -- -->

    <ui-stack gap="4">
    <h2>Open Command Palette</h2>
    <div class="trigger-area">
      <ui-button id="open-palette" intent="accent" size="lg">
        <ui-icon name="magnifying-glass" slot="leading"></ui-icon>
        <span slot="label">Open Command Palette</span>
      </ui-button>
      <p class="trigger-hint">
        or press <kbd>Ctrl</kbd> + <kbd>K</kbd> anywhere on the page
      </p>
    </div>

    <!-- -- Dialog with Command Palette -- -->

    <ui-dialog id="palette-dialog">
      <div class="dialog-panel">
        <ui-command id="palette-command">
          <ui-command-input>
            <ui-icon name="magnifying-glass"></ui-icon>
            <input type="text" placeholder="Type a command or search..." />
          </ui-command-input>
          <ui-command-list>
            <ui-command-group>
              <div slot="heading">Recent</div>
              <ui-command-item value="go-dashboard" keywords="home overview">
                <ui-icon name="house"></ui-icon> Dashboard
              </ui-command-item>
              <ui-command-item value="go-settings" keywords="preferences config">
                <ui-icon name="gear"></ui-icon> Settings
              </ui-command-item>
              <ui-command-item value="go-profile" keywords="account user">
                <ui-icon name="user"></ui-icon> Profile
              </ui-command-item>
            </ui-command-group>
            <ui-command-group>
              <div slot="heading">Actions</div>
              <ui-command-item value="create-project" keywords="new add">
                <ui-icon name="plus"></ui-icon> Create new project
                <span class="shortcut">Ctrl+N</span>
              </ui-command-item>
              <ui-command-item value="invite-member" keywords="team add user">
                <ui-icon name="user-plus"></ui-icon> Invite team member
              </ui-command-item>
              <ui-command-item value="export-data" keywords="download csv">
                <ui-icon name="arrow-right"></ui-icon> Export data
              </ui-command-item>
            </ui-command-group>
            <ui-command-group>
              <div slot="heading">Navigation</div>
              <ui-command-item value="nav-dashboard" keywords="home">
                <ui-icon name="house"></ui-icon> Go to Dashboard
                <span class="shortcut">G D</span>
              </ui-command-item>
              <ui-command-item value="nav-projects" keywords="work tasks">
                <ui-icon name="folder"></ui-icon> Go to Projects
                <span class="shortcut">G P</span>
              </ui-command-item>
              <ui-command-item value="nav-settings" keywords="preferences">
                <ui-icon name="gear"></ui-icon> Go to Settings
                <span class="shortcut">G S</span>
              </ui-command-item>
            </ui-command-group>
          </ui-command-list>
          <ui-command-empty>No matching commands found.</ui-command-empty>
        </ui-command>
      </div>
    </ui-dialog>
    </ui-stack>

    <!-- -- Inline Preview -- -->

    <ui-stack gap="4">
    <div>
      <h2>Inline Preview</h2>
      <p style="color: var(--neutral-ink-muted); font-size: 0.8125rem;">
        The same command palette rendered inline for reference.
      </p>
    </div>
    <div style="max-width: 32rem;">
      <ui-command>
        <ui-command-input>
          <ui-icon name="magnifying-glass"></ui-icon>
          <input type="text" placeholder="Type a command or search..." />
        </ui-command-input>
        <ui-command-list>
          <ui-command-group>
            <div slot="heading">Recent</div>
            <ui-command-item value="preview-dashboard">
              <ui-icon name="house"></ui-icon> Dashboard
            </ui-command-item>
            <ui-command-item value="preview-settings">
              <ui-icon name="gear"></ui-icon> Settings
            </ui-command-item>
          </ui-command-group>
          <ui-command-group>
            <div slot="heading">Actions</div>
            <ui-command-item value="preview-create">
              <ui-icon name="plus"></ui-icon> Create new project
            </ui-command-item>
            <ui-command-item value="preview-invite">
              <ui-icon name="user-plus"></ui-icon> Invite team member
            </ui-command-item>
          </ui-command-group>
        </ui-command-list>
        <ui-command-empty>No results.</ui-command-empty>
      </ui-command>
    </div>
    </ui-stack>
    </ui-stack>
  </main>

  <script>
const dialog = document.getElementById('palette-dialog');
      const command = document.getElementById('palette-command');

      // Open via button
      document.getElementById('open-palette').addEventListener('ui-press', () => {
        dialog.showModal();
        // Focus the input after dialog opens
        requestAnimationFrame(() => {
          const input = command.querySelector('input');
          if (input) input.focus();
        });
      });

      // Open via Ctrl+K global shortcut
      document.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
          e.preventDefault();
          dialog.showModal();
          requestAnimationFrame(() => {
            const input = command.querySelector('input');
            if (input) input.focus();
          });
        }
      });

      // Close dialog on command selection
      command.addEventListener('ui-change', (e) => {
        dialog.close();
      });

      // Close dialog on Escape (ui-dismiss from command)
      command.addEventListener('ui-dismiss', () => {
        dialog.close();
      });
  </script>
  <style is:global>
    .dialog-panel {
      background: var(--neutral-body);
      border: 1px solid var(--neutral-border-muted);
      border-radius: 0.75rem;
      box-shadow:
        0 8px 30px oklch(0% 0 0 / 0.12),
        0 2px 8px oklch(0% 0 0 / 0.06);
      width: min(32rem, calc(100vw - 2rem));
      overflow: hidden;
    }

    .shortcut {
      font-family: ui-monospace, monospace;
      font-size: 0.625rem;
      background: var(--neutral-panel);
      border: 1px solid var(--neutral-border-muted);
      border-radius: 0.25rem;
      padding: 0.125rem 0.375rem;
      margin-left: auto;
      color: var(--neutral-ink-muted);
    }

    .trigger-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.75rem;
      padding: 3rem 2rem;
      background: var(--neutral-body);
      border: 1px solid var(--neutral-border-muted);
      border-radius: 0.75rem;
      text-align: center;
    }

    .trigger-hint {
      font-size: 0.8125rem;
      color: var(--neutral-ink-muted);
    }

    .trigger-hint kbd {
      font-family: ui-monospace, monospace;
      font-size: 0.75rem;
      background: var(--neutral-panel);
      border: 1px solid var(--neutral-border-muted);
      border-radius: 0.25rem;
      padding: 0.125rem 0.375rem;
    }
</style>

</SidebarLayout>
