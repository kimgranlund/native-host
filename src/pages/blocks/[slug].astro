---
import SidebarLayout from '../../layouts/SidebarLayout.astro';
import { getSnippet, listSnippets } from '../../lib/snippets';
import sitemap from '../../data/sitemap.json';

export function getStaticPaths() {
  return listSnippets('blocks').map(({ slug }) => ({ params: { slug } }));
}

const { slug } = Astro.params;
const snippet = getSnippet(`blocks/${slug}.html`);
const entry = sitemap.find(e => e.path === `/blocks/${slug}`);
const title = entry?.title ?? snippet?.title ?? slug!;
---
<SidebarLayout title={title}>
  {snippet?.styles && <style set:html={snippet.styles} />}
  <main set:html={snippet?.content ?? ''} />
  {snippet?.scripts && <script set:html={snippet.scripts} type="module" />}
</SidebarLayout>
