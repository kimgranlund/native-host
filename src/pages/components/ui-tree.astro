---
import SidebarLayout from '../../layouts/SidebarLayout.astro';

const codeExamples = {
  eventLog: `&lt;ui-tree id="event-tree"&gt;
  &lt;ui-tree-item expanded&gt;
    &lt;span slot="label"&gt;Documents&lt;/span&gt;
    &lt;ui-tree-item&gt;
      &lt;span slot="label"&gt;report.pdf&lt;/span&gt;
    &lt;/ui-tree-item&gt;
  &lt;/ui-tree-item&gt;
&lt;/ui-tree&gt;

const tree = document.getElementById('event-tree');
tree.querySelectorAll('ui-tree-item').forEach((item) =&gt; {
  observer.observe(item, { attributes: true });
});`,
};
---
<SidebarLayout title="ui-tree">
  <main>
<h1>&lt;ui-tree&gt;</h1>
    <p style="color: var(--neutral-ink-muted); font-size: 0.875rem; margin-bottom: 1.5rem;">
      Hierarchical expandable tree. Arrow keys expand/collapse, Enter/Space select.
    </p>

    <!-- ── Basic ── -->

    <h2>File Browser</h2>
    <div class="layout-section">
      <ui-tree>
        <ui-tree-item expanded>
          <span slot="label">src</span>
          <ui-tree-item>
            <span slot="label">index.ts</span>
          </ui-tree-item>
          <ui-tree-item expanded>
            <span slot="label">components</span>
            <ui-tree-item>
              <span slot="label">ui-button.ts</span>
            </ui-tree-item>
            <ui-tree-item>
              <span slot="label">ui-input.ts</span>
            </ui-tree-item>
            <ui-tree-item>
              <span slot="label">ui-select.ts</span>
            </ui-tree-item>
          </ui-tree-item>
          <ui-tree-item>
            <span slot="label">styles</span>
            <ui-tree-item>
              <span slot="label">index.css</span>
            </ui-tree-item>
            <ui-tree-item>
              <span slot="label">colors.css</span>
            </ui-tree-item>
          </ui-tree-item>
        </ui-tree-item>
        <ui-tree-item>
          <span slot="label">package.json</span>
        </ui-tree-item>
        <ui-tree-item>
          <span slot="label">tsconfig.json</span>
        </ui-tree-item>
      </ui-tree>
    <pre class="layout-code"><code>&lt;ui-tree&gt;
  &lt;ui-tree-item expanded&gt;
    &lt;span slot="label"&gt;src&lt;/span&gt;
    &lt;ui-tree-item&gt;
      &lt;span slot="label"&gt;index.ts&lt;/span&gt;
    &lt;/ui-tree-item&gt;
    &lt;ui-tree-item expanded&gt;
      &lt;span slot="label"&gt;components&lt;/span&gt;
      &lt;ui-tree-item&gt;
        &lt;span slot="label"&gt;ui-button.ts&lt;/span&gt;
      &lt;/ui-tree-item&gt;
    &lt;/ui-tree-item&gt;
  &lt;/ui-tree-item&gt;
&lt;/ui-tree&gt;</code><ui-button class="copy-btn" size="sm" variant="ghost" aria-label="Copy"><ui-icon name="copy"></ui-icon></ui-button></pre>
    </div>

    <!-- ── Navigation ── -->

    <h2>Navigation</h2>
    <div class="layout-section">
      <ui-tree>
        <ui-tree-item expanded>
          <span slot="label">Getting Started</span>
          <ui-tree-item selected>
            <span slot="label">Installation</span>
          </ui-tree-item>
          <ui-tree-item>
            <span slot="label">Quick Start</span>
          </ui-tree-item>
        </ui-tree-item>
        <ui-tree-item>
          <span slot="label">Components</span>
          <ui-tree-item>
            <span slot="label">Buttons</span>
          </ui-tree-item>
          <ui-tree-item>
            <span slot="label">Inputs</span>
          </ui-tree-item>
          <ui-tree-item>
            <span slot="label">Selects</span>
          </ui-tree-item>
        </ui-tree-item>
        <ui-tree-item>
          <span slot="label">Theming</span>
          <ui-tree-item>
            <span slot="label">Colors</span>
          </ui-tree-item>
          <ui-tree-item>
            <span slot="label">Typography</span>
          </ui-tree-item>
        </ui-tree-item>
      </ui-tree>
    <pre class="layout-code"><code>&lt;ui-tree&gt;
  &lt;ui-tree-item expanded&gt;
    &lt;span slot="label"&gt;Getting Started&lt;/span&gt;
    &lt;ui-tree-item selected&gt;
      &lt;span slot="label"&gt;Installation&lt;/span&gt;
    &lt;/ui-tree-item&gt;
    &lt;ui-tree-item&gt;
      &lt;span slot="label"&gt;Quick Start&lt;/span&gt;
    &lt;/ui-tree-item&gt;
  &lt;/ui-tree-item&gt;
&lt;/ui-tree&gt;</code><ui-button class="copy-btn" size="sm" variant="ghost" aria-label="Copy"><ui-icon name="copy"></ui-icon></ui-button></pre>
    </div>

    <!-- ── Event Log ── -->

    <h2>Event Log</h2>
    <div class="layout-section">
      <ui-tree id="event-tree">
        <ui-tree-item expanded>
          <span slot="label">Documents</span>
          <ui-tree-item>
            <span slot="label">report.pdf</span>
          </ui-tree-item>
          <ui-tree-item>
            <span slot="label">notes.txt</span>
          </ui-tree-item>
        </ui-tree-item>
        <ui-tree-item>
          <span slot="label">Images</span>
          <ui-tree-item>
            <span slot="label">photo.jpg</span>
          </ui-tree-item>
        </ui-tree-item>
      </ui-tree>
      <div class="log" id="tree-log"></div>
    <pre class="layout-code"><code set:html={codeExamples.eventLog} /><ui-button class="copy-btn" size="sm" variant="ghost" aria-label="Copy"><ui-icon name="copy"></ui-icon></ui-button></pre>
    </div>

    <!-- ── Disabled ── -->

    <h2>Disabled</h2>
    <div class="layout-section">
      <ui-tree disabled>
        <ui-tree-item expanded>
          <span slot="label">Project</span>
          <ui-tree-item>
            <span slot="label">README.md</span>
          </ui-tree-item>
          <ui-tree-item>
            <span slot="label">package.json</span>
          </ui-tree-item>
        </ui-tree-item>
      </ui-tree>
    <pre class="layout-code"><code>&lt;ui-tree disabled&gt;
  &lt;ui-tree-item expanded&gt;
    &lt;span slot="label"&gt;Project&lt;/span&gt;
    &lt;ui-tree-item&gt;
      &lt;span slot="label"&gt;README.md&lt;/span&gt;
    &lt;/ui-tree-item&gt;
  &lt;/ui-tree-item&gt;
&lt;/ui-tree&gt;</code><ui-button class="copy-btn" size="sm" variant="ghost" aria-label="Copy"><ui-icon name="copy"></ui-icon></ui-button></pre>
    </div>

    <!-- ── Debug States (force-*) ── -->

    <h2>Debug States (<code>force-*</code>)</h2>
    <div class="layout-section">
      <p style="font-size: 0.75rem; color: var(--neutral-ink-muted); margin: 0 0 1rem;">
        Attribute-driven pseudo-state overrides for DevTools debugging and visual testing. Applied to individual <code>ui-tree-item</code> elements.
      </p>
      <ui-tree>
        <ui-tree-item force-hover>
          <span slot="label">Force hover</span>
        </ui-tree-item>
        <ui-tree-item force-focus-visible>
          <span slot="label">Force focus-visible</span>
        </ui-tree-item>
        <ui-tree-item>
          <span slot="label">Normal</span>
        </ui-tree-item>
      </ui-tree>
    </div>
  </main>

  <script>
// ── Copy buttons ──

      for (const btn of document.querySelectorAll('.copy-btn')) {
        btn.addEventListener('click', async () => {
          const code = btn.closest('.layout-code')?.querySelector('code');
          if (!code) return;
          await navigator.clipboard.writeText(code.textContent);
          const icon = btn.querySelector('ui-icon');
          if (icon) {
            icon.setAttribute('name', 'check');
            setTimeout(() => { icon.setAttribute('name', 'copy'); }, 1500);
          }
        });
      }

      // Event log for tree interactions
      const tree = document.getElementById('event-tree');
      const log = document.getElementById('tree-log');
      let count = 0;

      // Observe attribute changes on tree items to log select/expand/collapse
      const observer = new MutationObserver((mutations) => {
        for (const m of mutations) {
          if (m.type !== 'attributes') continue;
          const item = m.target;
          const label = item.querySelector(':scope > [slot="label"]')?.textContent?.trim() ?? '?';
          if (m.attributeName === 'selected' && item.hasAttribute('selected')) {
            count++;
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `#${count} selected — "${label}"`;
            log.prepend(entry);
          } else if (m.attributeName === 'expanded') {
            count++;
            const expanded = item.hasAttribute('expanded');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `#${count} ${expanded ? 'expanded' : 'collapsed'} — "${label}"`;
            log.prepend(entry);
          }
        }
      });

      tree.querySelectorAll('ui-tree-item').forEach((item) => {
        observer.observe(item, { attributes: true, attributeFilter: ['selected', 'expanded'] });
      });
  </script>
</SidebarLayout>
